# InfluencerFlow AI Platform

The InfluencerFlow AI Platform is a backend API for managing influencer campaigns, creator discovery, and campaign analytics.

## Features

- AI-powered creator discovery and matching
- Campaign management
- Contract generation and management
- Outreach management (IRM)
- Payment processing (mock implementation)
- Analytics and reporting

## Tech Stack

- **Framework**: FastAPI (Python)
- **Database**: PostgreSQL with SQLAlchemy ORM
- **Caching**: Redis
- **AI/ML**: OpenAI GPT-4 API
- **Package Manager**: uv (ultra-fast Python package manager)
- **File Storage**: Local filesystem (for MVP)
- **Task Queue**: Celery with Redis (coming soon)

## Project Structure

```
influencerflow/
├── app/                  # Application code
│   ├── main.py           # FastAPI application entry point
│   ├── core/             # Core configuration
│   ├── models/           # Database models
│   ├── schemas/          # Pydantic schemas
│   ├── api/              # API endpoints
│   ├── services/         # Business logic
│   └── utils/            # Utilities and helpers
├── scripts/              # Utility scripts
│   ├── init_db.py        # Initialize database
│   ├── seed_data.py      # Seed database with mock data
│   ├── test_api.py       # Test API endpoints
│   ├── run_app.py        # Script to run the application
│   └── clean_env.py      # Script to clean up the environment
├── main.py               # Root-level entry point for the application
├── pyproject.toml        # Project metadata and dependencies
├── requirements.lock     # Locked dependencies (generated by uv)
├── uv.lock               # uv lock file for reproducible environments
├── .python-version       # Python version specification for uv
├── Dockerfile            # Docker configuration
└── docker-compose.yml    # Docker Compose setup
└── clean_env.bat         # Windows batch file to clean environment
```

## Setup Instructions

### Prerequisites

- Python 3.9+
- [uv](https://docs.astral.sh/uv/) - Fast Python package manager
- PostgreSQL (or Supabase for hosted database)
- Redis
- OpenAI API key (for AI features)

### Installation Options

#### Using uv (Recommended)

1. Install uv if you don't have it already:
   ```bash
   curl -LsSf https://astral.sh/uv/install.sh | sh
   ```

2. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/influencerflow.git
   cd influencerflow
   ```

3. Install dependencies and create virtual environment:
   ```bash
   uv pip install -e .
   ```
   
   This will automatically create a `.venv` directory and install all dependencies specified in pyproject.toml.

4. Set up environment variables:
   ```bash
   cp .env.example .env
   # Edit .env with your own values
   ```

5. Initialize the database (if using local PostgreSQL):
   ```bash
   uv run scripts/init_db.py
   ```

6. Seed the database with mock data:
   ```bash
   uv run scripts/seed_data.py
   ```

7. Run the application:
   ```bash
   uv run main.py
   ```
   
   Alternatively, you can use uvicorn directly:
   ```bash
   uv run -- uvicorn app.main:app --reload
   ```

#### Using Docker (Alternative)

1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/influencerflow.git
   cd influencerflow
   ```

2. Create a .env file:
   ```bash
   cp .env.example .env
   # Edit .env with your own values
   ```

3. Start the Docker containers:
   ```bash
   docker-compose up -d
   ```

4. The API will be available at `http://localhost:8000`

## Using uv with the Project

### Running the Application

The recommended way to run the application during development is with uv:

```bash
# Run the application with auto-reload for development
uv run main.py

# Run with specific environment variables
ENVIRONMENT=production uv run main.py

# Run with a specific port
PORT=9000 uv run main.py
```

### Running Scripts

InfluencerFlow includes utility scripts that can be run with uv:

```bash
# Initialize the database
uv run scripts/init_db.py

# Seed the database with mock data
uv run scripts/seed_data.py

# Test API endpoints
uv run scripts/test_api.py
```

### Managing Dependencies

Add new dependencies to the project:

```bash
# Add a runtime dependency
uv add fastapi

# Add a development dependency
uv add --dev pytest
```

Update dependencies and regenerate the lock file:

```bash
uv lock
```

To update a specific package:

```bash
uv lock --upgrade-package fastapi
```

Sync your environment with the locked dependencies:

```bash
uv sync
```

### Project Tasks

You can run common tasks using uv:

```bash
# Lint the code
uv run ruff check .

# Format the code
uv run black .

# Run tests
uv run pytest
```

### Lockfile Management

InfluencerFlow uses `uv.lock` to ensure reproducible environments. This lockfile should be committed to version control.

To create or update the lockfile:

```bash
uv lock
```

To sync your environment with the locked dependencies:

```bash
uv sync
```

When deploying to production, the lockfile ensures that exactly the same dependencies are installed:

```bash
uv pip install -r uv.lock
```

### Virtual Environment Management

#### Cleaning Up Old Virtual Environments

If you need to clean up and recreate your virtual environment, you can use the provided scripts:

```bash
# On Linux/macOS
uv run scripts/clean_env.py

# On Windows
clean_env.bat
```

Or manually:

```bash
# Remove the existing virtual environment
rm -rf .venv

# Create a fresh virtual environment and install dependencies
uv pip install -e .
```

For a complete reset of uv's cache:

```bash
# Remove the virtual environment
rm -rf .venv

# Clear uv's cache
uv cache clean

# Regenerate the lockfile
uv lock

# Create a fresh environment with the latest dependencies
uv pip install -e .
```

#### Switching Python Versions

If you need to switch to a different Python version:

1. Update the `.python-version` file with the new version
2. Update the `python-preference` in the `[tool.uv]` section of `pyproject.toml`:
   ```toml
   [tool.uv]
   python-preference = ["3.9.0"]  # Change to your desired version
   ```
3. Clean up and recreate the environment using one of the cleanup scripts

## API Documentation

Once the application is running, you can access the API documentation at:

- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

## Main Endpoints

### Creator Discovery

- `GET /api/v1/creators` - Search and filter creators
- `POST /api/v1/creators/search` - AI-powered creator search
- `GET /api/v1/creators/{creator_id}` - Get detailed creator profile

### Campaign Management

- `POST /api/v1/campaigns` - Create a new campaign
- `GET /api/v1/campaigns` - List all campaigns
- `GET /api/v1/campaigns/{campaign_id}` - Get campaign details
- `POST /api/v1/campaigns/{campaign_id}/select-influencer` - Select influencer for campaign
- `POST /api/v1/campaigns/{campaign_id}/ai-match-analysis` - Get AI match analysis

### Outreach Management

- `GET /api/v1/outreach/dashboard` - Get outreach management overview
- `POST /api/v1/outreach/call/schedule` - Schedule a call with influencer
- `POST /api/v1/outreach/call/complete` - Mark call as completed
- `GET /api/v1/outreach/call/{call_id}/transcript` - Get call transcript

### Contract Management

- `POST /api/v1/contracts` - Create a new contract
- `GET /api/v1/contracts` - List contracts
- `GET /api/v1/contracts/{contract_id}` - Get contract details
- `GET /api/v1/contracts/{contract_id}/pdf` - Generate contract PDF

### Payment Management

- `GET /api/v1/payments` - List payments
- `POST /api/v1/payments/{payment_id}/process` - Process payment
- `GET /api/v1/payments/dashboard` - Payment dashboard summary

### Analytics

- `GET /api/v1/analytics/campaigns/{campaign_id}` - Campaign performance analytics
- `GET /api/v1/analytics/dashboard` - Overall platform analytics

## License

[MIT License](LICENSE)